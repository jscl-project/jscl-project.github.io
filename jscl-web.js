if (typeof importScripts !== 'undefined') importScripts('jscl.js');
(function(jscl){
'use strict';
(function(values, internals){var l1=internals.make_lisp_string('loading repl-web/repl.lisp!');
console.log(internals.xstring(l1));
var l2=internals.intern('%WRITE-STRING','JSCL');
var l3=internals.intern('T');
var l4=internals.make_lisp_string('jqconsole-output');
var l5=internals.intern('*ROOT*','JSCL');
var l6=internals.intern('NIL');
var l7=internals.make_lisp_string('');
l2.fvalue=(function(){var FUNC=(function JSCL_USER_WRITESTRING(values,v1,v2,v3){internals.checkArgsAtLeast(arguments.length-1,1);
internals.checkArgsAtMost(arguments.length-1,3);
switch(arguments.length-1){case 1:v2=l3.value;
;
case 2:v3=l4;
;
default:break;
}var v4=this;
return (function(){return internals.js_to_lisp((function(){var TMP=internals.symbolValue(l5)['jqconsole'];
return TMP===undefined?l6.value:TMP;
})())!==l6.value?v2!==l6.value?internals.js_to_lisp(internals.symbolValue(l5)['jqconsole']['Write'](internals.lisp_to_js(v1),internals.lisp_to_js(v3))):internals.js_to_lisp(internals.symbolValue(l5)['jqconsole']['Write'](internals.lisp_to_js(v1),internals.lisp_to_js(v3),internals.lisp_to_js(l7))):internals.js_to_lisp(internals.symbolValue(l5)['console']['log'](internals.lisp_to_js(v1)));
})();
});
FUNC.fname='%WRITE-STRING';
return FUNC;
})();
l2;
var l8=internals.intern('LOAD-HISTORY','JSCL');
var l9=internals.make_lisp_string('jqhist');
l8.fvalue=(function(){var FUNC=(function JSCL_USER_LOADHISTORY(values){internals.checkArgsAtMost(arguments.length-1,0);
var v6=this;
return (function(){return (function(v8){return (v8===null?l3.value:l6.value)!==l6.value?l6.value:internals.js_to_lisp(internals.symbolValue(l5)['jqconsole']['SetHistory'](internals.lisp_to_js(internals.js_to_lisp(internals.symbolValue(l5)['JSON']['parse'](internals.lisp_to_js(v8))))));
})(internals.js_to_lisp(internals.symbolValue(l5)['localStorage']['getItem'](internals.lisp_to_js(l9))));
})();
});
FUNC.fname='LOAD-HISTORY';
return FUNC;
})();
l8;
var l10=internals.intern('SAVE-HISTORY','JSCL');
var l11=internals.make_lisp_string('jqhist');
l10.fvalue=(function(){var FUNC=(function JSCL_USER_SAVEHISTORY(values){internals.checkArgsAtMost(arguments.length-1,0);
var v9=this;
return (function(){return internals.js_to_lisp(internals.symbolValue(l5)['localStorage']['setItem'](internals.lisp_to_js(l11),internals.lisp_to_js(internals.js_to_lisp(internals.symbolValue(l5)['JSON']['stringify'](internals.lisp_to_js(internals.js_to_lisp(internals.symbolValue(l5)['jqconsole']['GetHistory']())))))));
})();
});
FUNC.fname='SAVE-HISTORY';
return FUNC;
})();
l10;
var l12=internals.intern('+ERR-CSS+','JSCL');
var l13=internals.make_lisp_string('jqconsole-error');
l12.value=l13;
l12;
var l14=internals.intern('TOPLEVEL','JSCL');
var l15=internals.make_lisp_string('(');
var l16=internals.make_lisp_string(')');
var l17=internals.make_lisp_string('parents');
var l18=internals.intern('FORMAT-ERROR','JSCL');
var l19=internals.intern('COMPLAINT','KEYWORD');
l19.value=l19;
var l20=internals.make_lisp_string('Required argument missing');
var l21=internals.intern('CONTROL-STRING','KEYWORD');
l21.value=l21;
var l22=internals.make_lisp_string('~a> ');
var l23=internals.intern('OFFSET','KEYWORD');
l23.value=l23;
var l24=internals.intern('ERROR');
var l25=internals.intern('PRINC');
var l26=internals.make_lisp_string('> ');
var l27=internals.intern('WRITE-STRING');
var l28=internals.intern('*PACKAGE*');
var l29=internals.intern('PACKAGE-NAME-FOR-PROMPT','JSCL');
var l30=internals.intern('CALL-FORMATTER','JSCL');
var l31=internals.make_lisp_string('jqconsole-prompt');
var l32=internals.intern('*ERROR-OUTPUT*');
var l33=internals.make_lisp_string('ERROR[!]: ~a~%~A~%');
var l34=internals.make_lisp_string('ERROR[!]: ');
var l35=internals.intern('TERPRI');
var l36=internals.intern('*HANDLER-BINDINGS*','JSCL');
var l37=internals.intern('SERIOUS-CONDITION');
var l38=internals.make_lisp_string('~A: ~A~%');
var l39=internals.make_lisp_string(': ');
var l40=internals.intern('CLASS-OF');
var l41=internals.intern('CLASS-NAME');
var l42=internals.intern('*TRACE-OUTPUT*');
var l43=internals.intern('FROM','KEYWORD');
l43.value=l43;
var l44=internals.intern('SIGNAL');
var l45=internals.intern('FORMAT-BACKTRACE','JSCL');
var l46=internals.intern('%%ERROR','JSCL');
var l47=internals.intern('LIST');
var l48=internals.intern('EVAL-INTERACTIVE-INPUT','JSCL');
var l49=internals.intern('FRESH-LINE');
var l50=internals.intern('PRIN1');
var l51=internals.intern('%SEXPR-INCOMPLETE','JSCL');
l14.fvalue=(function(){var FUNC=(function JSCL_USER_TOPLEVEL(values){internals.checkArgsAtMost(arguments.length-1,0);
var v11=this;
return (function(){internals.js_to_lisp(internals.symbolValue(l5)['jqconsole']['RegisterMatching'](internals.lisp_to_js(l15),internals.lisp_to_js(l16),internals.lisp_to_js(l17)));
(function(v18){return internals.js_to_lisp(internals.symbolValue(l5)['jqconsole']['Write'](internals.lisp_to_js(v18),internals.lisp_to_js(l31)));
})(l30.fvalue(internals.pv,l6.value,(function JSCL_USER_NIL(values,v14,v15){internals.checkArgsAtLeast(arguments.length-1,1);
switch(arguments.length-1){case 1:v15=l24.fvalue(internals.pv,l18,l19.value,l20,l21.value,l22,l23.value,1);
;
default:break;
}var v13=l6.value;
var I;
for (I=arguments.length-1-1;I>=2;I--)v13=new internals.Cons(arguments[I+1],v13);
var v16=this;
(function(){l25.fvalue(internals.pv,v15,v14);
return l27.fvalue(internals.pv,l26,v14);
})();
return v13;
}),l29.fvalue(internals.pv,internals.symbolValue(l28))));
return (function(v49){return internals.js_to_lisp(internals.symbolValue(l5)['jqconsole']['Prompt'](internals.lisp_to_js(l3.value),internals.lisp_to_js(v49),internals.lisp_to_js(internals.symbolFunction(l51))));
})((function JSCL_USER_NIL(values,v19){internals.checkArgs(arguments.length-1,1);
var v20=this;
return (function(){(function(){try{return (function(){try{var v31=[];
return (function(v32){return internals.bindSpecialBindings([l36],[v32],(function(){(function(){var v34=new internals.Cons(l37,(function JSCL_USER_NIL(values,v35){internals.checkArgs(arguments.length-1,1);
var v36=this;
l30.fvalue(internals.pv,internals.symbolValue(l32),(function JSCL_USER_NIL(values,v38,v39,v40){internals.checkArgsAtLeast(arguments.length-1,1);
switch(arguments.length-1){case 1:v39=l24.fvalue(internals.pv,l18,l19.value,l20,l21.value,l38,l23.value,1);
;
case 2:v40=l24.fvalue(internals.pv,l18,l19.value,l20,l21.value,l38,l23.value,5);
;
default:break;
}var v37=l6.value;
var I;
for (I=arguments.length-1-1;I>=3;I--)v37=new internals.Cons(arguments[I+1],v37);
var v41=this;
(function(){l25.fvalue(internals.pv,v39,v38);
l27.fvalue(internals.pv,l39,v38);
l25.fvalue(internals.pv,v40,v38);
return l35.fvalue(internals.pv,v38);
})();
return v37;
}),l41.fvalue(internals.pv,l40.fvalue(internals.pv,v35)),v35);
l45.fvalue(internals.pv,internals.symbolValue(l42),l43.value,internals.symbolFunction(l44));
return (function(){throw new internals.BlockNLX(v31,l6.value,'BAIL-OUT');
})();
}));
var v43=new internals.Cons(v34,internals.symbolValue(l36));
return l36.value=v43;
})();
return (function(){try{return (function(){return (function(v47,v48){(function(){while (v47!==l6.value){v48=v47.$$jscl_car;
l49.fvalue(internals.pv);
l50.fvalue(internals.pv,v48);
l35.fvalue(internals.pv);
l6.value;
v47=v47.$$jscl_cdr;
}return l6.value;
})();
return l6.value;
})((function(){var FUNC=internals.symbolFunction(l47);
var ARGS=[internals.pv];
return (function(){var values=internals.mv;
var VS;
VS=l48.fvalue(values,v19);
if (typeof VS==='object'&&VS&&'multiple-value' in VS) ARGS=ARGS.concat(VS);
 else ARGS.push(VS);
return FUNC.apply(null,ARGS);
})();
})(),l6.value);
})();
}catch (v44){v44=internals.js_to_lisp(v44);
return (internals.isNLX(v44)?l3.value:l6.value)!==l6.value?(function(){throw v44;
})():l46.fvalue(internals.pv,(function(v45){return v45!==l6.value?v45:v44;
})(internals.js_to_lisp((function(){var TMP=v44['message'];
return TMP===undefined?l6.value:TMP;
})())));
}})();
}));
})(internals.symbolValue(l36));
}catch (CF){if (CF instanceof internals.BlockNLX&&CF.id==v31) return CF.values;
 else throw CF;
}})();
}catch (v22){v22=internals.js_to_lisp(v22);
return (function(v24){return l30.fvalue(internals.pv,internals.symbolValue(l32),(function JSCL_USER_NIL(values,v26,v27,v28){internals.checkArgsAtLeast(arguments.length-1,1);
switch(arguments.length-1){case 1:v27=l24.fvalue(internals.pv,l18,l19.value,l20,l21.value,l33,l23.value,11);
;
case 2:v28=l24.fvalue(internals.pv,l18,l19.value,l20,l21.value,l33,l23.value,15);
;
default:break;
}var v25=l6.value;
var I;
for (I=arguments.length-1-1;I>=3;I--)v25=new internals.Cons(arguments[I+1],v25);
var v29=this;
(function(){l27.fvalue(internals.pv,l34,v26);
l25.fvalue(internals.pv,v27,v26);
l35.fvalue(internals.pv,v26);
l25.fvalue(internals.pv,v28,v26);
return l35.fvalue(internals.pv,v26);
})();
return v25;
}),v24,internals.js_to_lisp((function(){var TMP=v22['stack'];
return TMP===undefined?l6.value:TMP;
})()));
})((function(v23){return v23!==l6.value?v23:v22;
})(internals.js_to_lisp((function(){var TMP=v22['message'];
return TMP===undefined?l6.value:TMP;
})())));
}})();
l10.fvalue(internals.pv);
return l14.fvalue(values);
})();
}));
})();
});
FUNC.fname='TOPLEVEL';
return FUNC;
})();
l14;
var l52=internals.intern('WEB-INIT','JSCL');
var l53=internals.intern('*STANDARD-OUTPUT*');
var l54=internals.intern('WRITE-FN','KEYWORD');
l54.value=l54;
var l55=internals.intern('KIND','KEYWORD');
l55.value=l55;
var l56=internals.intern('WEB-REPL-OUTPUT-STREAM','JSCL');
var l57=internals.intern('MAKE-STREAM','JSCL');
var l58=internals.intern('WEB-REPL-ERROR-STREAM','JSCL');
var l59=internals.intern('HTML','KEYWORD');
l59.value=l59;
var l60=internals.intern('WELCOME-MESSAGE','JSCL');
var l61=internals.make_lisp_string('load');
l52.fvalue=(function(){var FUNC=(function JSCL_USER_WEBINIT(values){internals.checkArgsAtMost(arguments.length-1,0);
var v50=this;
return (function(){l8.fvalue(internals.pv);
l53.value=l57.fvalue(internals.pv,l54.value,(function JSCL_USER_NIL(values,v52){internals.checkArgs(arguments.length-1,1);
var v53=this;
return l2.fvalue(values,v52);
}),l55.value,l56);
l32.value=l57.fvalue(internals.pv,l54.value,(function JSCL_USER_NIL(values,v54){internals.checkArgs(arguments.length-1,1);
var v55=this;
return l2.fvalue(values,v54,l3.value,internals.symbolValue(l12));
}),l55.value,l58);
l42.value=internals.symbolValue(l53);
l60.fvalue(internals.pv,l59.value,l3.value);
return internals.js_to_lisp(internals.symbolValue(l5)['window']['addEventListener'](internals.lisp_to_js(l61),internals.lisp_to_js((function JSCL_USER_NIL(values){var v58=l6.value;
var I;
for (I=arguments.length-1-1;I>=0;I--)v58=new internals.Cons(arguments[I+1],v58);
var v59=this;
return l14.fvalue(values);
}))));
})();
});
FUNC.fname='WEB-INIT';
return FUNC;
})();
l52;
l52.fvalue(internals.pv);
})(jscl.internals.pv, jscl.internals);
})( typeof require !== 'undefined'? require('./jscl'):
typeof window !== 'undefined'? window.jscl: self.jscl )