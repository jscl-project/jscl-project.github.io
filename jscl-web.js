if (typeof importScripts !== 'undefined') importScripts('./jscl.js');
(function(jscl){
'use strict';
(function(internals){ var values = internals.values;var l1=internals.make_lisp_string('loading repl-web/repl.lisp!');
console.log(internals.xstring(l1));
var l2=internals.intern('%WRITE-STRING','JSCL');
var l3=internals.intern('T');
var l4=internals.make_lisp_string('jqconsole-output');
var l5=internals.intern('*ROOT*','JSCL');
var l6=internals.intern('NIL');
l2.fvalue=(function(){var FUNC=(function JSCL_USER_WRITESTRING(v1,v2,v3){internals.checkArgsAtLeast(arguments.length,1);
internals.checkArgsAtMost(arguments.length,3);
switch(arguments.length){case 1:v2=l3.value;
;
case 2:v3=l4;
;
default:break;
}var v4=this;
return (function(){return (function(v6,v7){return internals.symbolValue(l5)['jqconsole']!==l6.value?v2!==l6.value?internals.symbolValue(l5)['jqconsole']['Write'](v6,v7):internals.symbolValue(l5)['jqconsole']['Write'](v6,v7,''):internals.symbolValue(l5)['console']['log'](v6);
})(internals.xstring(v1),internals.xstring(v3));
})();
});
FUNC.fname='%WRITE-STRING';
return FUNC;
})();
l2;
var l7=internals.intern('LOAD-HISTORY','JSCL');
l7.fvalue=(function(){var FUNC=(function JSCL_USER_LOADHISTORY(){internals.checkArgsAtMost(arguments.length,0);
var v8=this;
return (function(){return (function(v10){return (v10===null?l3.value:l6.value)!==l6.value?l6.value:internals.symbolValue(l5)['jqconsole']['SetHistory'](internals.symbolValue(l5)['JSON']['parse'](v10));
})(internals.symbolValue(l5)['localStorage']['getItem']('jqhist'));
})();
});
FUNC.fname='LOAD-HISTORY';
return FUNC;
})();
l7;
var l8=internals.intern('SAVE-HISTORY','JSCL');
l8.fvalue=(function(){var FUNC=(function JSCL_USER_SAVEHISTORY(){internals.checkArgsAtMost(arguments.length,0);
var v11=this;
return (function(){return internals.symbolValue(l5)['localStorage']['setItem']('jqhist',internals.symbolValue(l5)['JSON']['stringify'](internals.symbolValue(l5)['jqconsole']['GetHistory']()));
})();
});
FUNC.fname='SAVE-HISTORY';
return FUNC;
})();
l8;
var l9=internals.intern('+ERR-CSS+','JSCL');
var l10=internals.make_lisp_string('jqconsole-error');
l9.value=l10;
l9;
var l11=internals.intern('TOPLEVEL','JSCL');
var l12=internals.intern('FORMAT-ERROR','JSCL');
var l13=internals.intern('COMPLAINT','KEYWORD');
l13.value=l13;
var l14=internals.make_lisp_string('Required argument missing');
var l15=internals.intern('CONTROL-STRING','KEYWORD');
l15.value=l15;
var l16=internals.make_lisp_string('~a> ');
var l17=internals.intern('OFFSET','KEYWORD');
l17.value=l17;
var l18=internals.intern('ERROR');
var l19=internals.intern('PRINC');
var l20=internals.make_lisp_string('> ');
var l21=internals.intern('WRITE-STRING');
var l22=internals.intern('*PACKAGE*');
var l23=internals.intern('PACKAGE-NAME-FOR-PROMPT','JSCL');
var l24=internals.intern('CALL-FORMATTER','JSCL');
var l25=internals.intern('CLSTRING','JSCL');
var l26=internals.intern('*ERROR-OUTPUT*');
var l27=internals.make_lisp_string('ERROR[!]: ~a~%~A~%');
var l28=internals.make_lisp_string('ERROR[!]: ');
var l29=internals.intern('TERPRI');
var l30=internals.make_lisp_string('');
var l31=internals.intern('*HANDLER-BINDINGS*','JSCL');
var l32=internals.intern('SERIOUS-CONDITION');
var l33=internals.make_lisp_string('~A: ~A~%');
var l34=internals.make_lisp_string(': ');
var l35=internals.intern('CLASS-OF');
var l36=internals.intern('CLASS-NAME');
var l37=internals.intern('*TRACE-OUTPUT*');
var l38=internals.intern('FROM','KEYWORD');
l38.value=l38;
var l39=internals.intern('SIGNAL');
var l40=internals.intern('FORMAT-BACKTRACE','JSCL');
var l41=internals.intern('%%ERROR','JSCL');
var l42=internals.intern('LIST');
var l43=internals.intern('EVAL-INTERACTIVE-INPUT','JSCL');
var l44=internals.intern('FRESH-LINE');
var l45=internals.intern('PRIN1');
var l46=internals.intern('%SEXPR-INCOMPLETE','JSCL');
l11.fvalue=(function(){var FUNC=(function JSCL_USER_TOPLEVEL(){internals.checkArgsAtMost(arguments.length,0);
var v13=this;
return (function(){internals.symbolValue(l5)['jqconsole']['RegisterMatching']('(',')','parents');
(function(v20){return internals.symbolValue(l5)['jqconsole']['Write'](v20,'jqconsole-prompt');
})(internals.xstring(l24.fvalue(l6.value,(function JSCL_USER_NIL(v16,v17){internals.checkArgsAtLeast(arguments.length,1);
switch(arguments.length){case 1:v17=l18.fvalue(l12,l13.value,l14,l15.value,l16,l17.value,1);
;
default:break;
}var v15=l6.value;
var I;
for (I=arguments.length-1;I>=2;I--)v15=new internals.Cons(arguments[I],v15);
var v18=this;
(function(){l19.fvalue(v17,v16);
return l21.fvalue(l20,v16);
})();
return v15;
}),l23.fvalue(internals.symbolValue(l22)))));
return (function(v51){return internals.symbolValue(l5)['jqconsole']['Prompt'](true,v51,(function JSCL_USER_NIL(v57){internals.checkArgsAtLeast(arguments.length,1);
var v56=l6.value;
var I;
for (I=arguments.length-1;I>=1;I--)v56=new internals.Cons(arguments[I],v56);
var v58=this;
return (function(v59){return v59!==l6.value?v59:false;
})(l46.fvalue(l25.fvalue(v57)));
}));
})((function JSCL_USER_NIL(v21){internals.checkArgs(arguments.length,1);
var v22=this;
return (function(){(function(){try{return (function(){try{var v33=[];
return (function(v34){return internals.bindSpecialBindings([l31],[v34],(function(){(function(){var v36=new internals.Cons(l32,(function JSCL_USER_NIL(v37){internals.checkArgs(arguments.length,1);
var v38=this;
l24.fvalue(internals.symbolValue(l26),(function JSCL_USER_NIL(v40,v41,v42){internals.checkArgsAtLeast(arguments.length,1);
switch(arguments.length){case 1:v41=l18.fvalue(l12,l13.value,l14,l15.value,l33,l17.value,1);
;
case 2:v42=l18.fvalue(l12,l13.value,l14,l15.value,l33,l17.value,5);
;
default:break;
}var v39=l6.value;
var I;
for (I=arguments.length-1;I>=3;I--)v39=new internals.Cons(arguments[I],v39);
var v43=this;
(function(){l19.fvalue(v41,v40);
l21.fvalue(l34,v40);
l19.fvalue(v42,v40);
return l29.fvalue(v40);
})();
return v39;
}),l36.fvalue(l35.fvalue(v37)),v37);
l40.fvalue(internals.symbolValue(l37),l38.value,internals.symbolFunction(l39));
return (function(){throw new internals.BlockNLX(v33,l6.value,null,'BAIL-OUT');
})();
}));
var v45=new internals.Cons(v36,internals.symbolValue(l31));
return l31.value=v45;
})();
return (function(){try{return (function(){return (function(v49,v50){(function(){while (v49!==l6.value){v50=v49.$$jscl_car;
l44.fvalue();
l45.fvalue(v50);
l29.fvalue();
l6.value;
v49=v49.$$jscl_cdr;
}return l6.value;
})();
return l6.value;
})((function(){var FUNC=internals.symbolFunction(l42);
var ARGS=[];
var _R;
_R=internals.withMV((function(){return internals.mvcall(l43.fvalue,l25.fvalue(v21));
}));
if (_R.mv!==null) ARGS=ARGS.concat(_R.mv);
 else ARGS.push(_R.result);
return internals.mvcall(FUNC,...ARGS);
})(),l6.value);
})();
}catch (v46){return (internals.isNLX(v46)?l3.value:l6.value)!==l6.value?(function(){throw v46;
})():l41.fvalue((function(v47){return (v47===undefined?l3.value:l6.value)!==l6.value?l25.fvalue(v46):l25.fvalue(v47);
})(v46['message']));
}})();
}));
})(internals.symbolValue(l31));
}catch (CF){if (CF instanceof internals.BlockNLX&&CF.id==v33) return CF.value;
 else throw CF;
}})();
}catch (v24){return (function(v26){return l24.fvalue(internals.symbolValue(l26),(function JSCL_USER_NIL(v28,v29,v30){internals.checkArgsAtLeast(arguments.length,1);
switch(arguments.length){case 1:v29=l18.fvalue(l12,l13.value,l14,l15.value,l27,l17.value,11);
;
case 2:v30=l18.fvalue(l12,l13.value,l14,l15.value,l27,l17.value,15);
;
default:break;
}var v27=l6.value;
var I;
for (I=arguments.length-1;I>=3;I--)v27=new internals.Cons(arguments[I],v27);
var v31=this;
(function(){l21.fvalue(l28,v28);
l19.fvalue(v29,v28);
l29.fvalue(v28);
l19.fvalue(v30,v28);
return l29.fvalue(v28);
})();
return v27;
}),v26,l25.fvalue(v24['stack']??l30));
})((function(v25){return (v25===undefined?l3.value:l6.value)!==l6.value?l25.fvalue(v24):l25.fvalue(v25);
})(v24['message']));
}})();
l8.fvalue();
return internals.mvcall(l11.fvalue);
})();
}));
})();
});
FUNC.fname='TOPLEVEL';
return FUNC;
})();
l11;
var l47=internals.intern('WEB-INIT','JSCL');
var l48=internals.intern('*STANDARD-OUTPUT*');
var l49=internals.intern('WRITE-FN','KEYWORD');
l49.value=l49;
var l50=internals.intern('KIND','KEYWORD');
l50.value=l50;
var l51=internals.intern('WEB-REPL-OUTPUT-STREAM','JSCL');
var l52=internals.intern('MAKE-STREAM','JSCL');
var l53=internals.intern('WEB-REPL-ERROR-STREAM','JSCL');
var l54=internals.intern('HTML','KEYWORD');
l54.value=l54;
var l55=internals.intern('WELCOME-MESSAGE','JSCL');
l47.fvalue=(function(){var FUNC=(function JSCL_USER_WEBINIT(){internals.checkArgsAtMost(arguments.length,0);
var v60=this;
return (function(){l7.fvalue();
l48.value=l52.fvalue(l49.value,(function JSCL_USER_NIL(v62){internals.checkArgs(arguments.length,1);
var v63=this;
return internals.mvcall(l2.fvalue,v62);
}),l50.value,l51);
l26.value=l52.fvalue(l49.value,(function JSCL_USER_NIL(v64){internals.checkArgs(arguments.length,1);
var v65=this;
return internals.mvcall(l2.fvalue,v64,l3.value,internals.symbolValue(l9));
}),l50.value,l53);
l37.value=internals.symbolValue(l48);
l55.fvalue(l54.value,l3.value);
return internals.symbolValue(l5)['window']['addEventListener']('load',(function JSCL_USER_NIL(){var v68=l6.value;
var I;
for (I=arguments.length-1;I>=0;I--)v68=new internals.Cons(arguments[I],v68);
var v69=this;
return internals.mvcall(l11.fvalue);
}));
})();
});
FUNC.fname='WEB-INIT';
return FUNC;
})();
l47;
l47.fvalue();
})(jscl.internals);
})( typeof require !== 'undefined'? require('./jscl'):
typeof window !== 'undefined'? window.jscl: self.jscl )